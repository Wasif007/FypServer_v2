(function(){angular.module("pingFyp",["ngRoute","ngSanitize","ui.bootstrap"]);function e(e,n){e.when("/signup",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/supervisor",{templateUrl:"/supervisor/supervisor.view.html",controller:"supervisorCtrl",controllerAs:"vm"}).when("/modules",{templateUrl:"/modules/modules.view.html",controllerAs:"vm",controller:"modulesCtrl"}).when("/addguard",{templateUrl:"/addguard/addguard.view.html",controller:"addguardCtrl",controllerAs:"vm"}).when("/history",{templateUrl:"/history/history.view.html",controller:"historyCtrl",controllerAs:"vm"}).when("/assign",{templateUrl:"/assign/assign.view.html",controller:"assignCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/login"});n.html5Mode(true)}function n(e,n,r){e.$on("$routeChangeStart",function(e,t,o){if(n.path()==="/profile"&&!r.isLoggedIn()){n.path("/")}})}angular.module("pingFyp").config(["$routeProvider","$locationProvider",e]).run(["$rootScope","$location","authentication",n])})();(function(){angular.module("pingFyp").controller("supervisorCtrl",e);function e(){var e=this}})();(function(){angular.module("pingFyp").controller("modulesCtrl",e);function e(){var e=this}})();(function(){angular.module("pingFyp").controller("assignCtrl",e);function e(){var e=this}})();(function(){angular.module("pingFyp").directive("fileModel",e);e.$inject=["$parse"];function e(e){return{restrict:"A",link:function(n,r,t){var o=e(t.fileModel);var i=o.assign;r.bind("change",function(){n.$apply(function(){i(n,r[0].files[0])})})}}}})();(function(){angular.module("pingFyp").service("multipartForm",e);e.$inject=["$http"];function e(e){this.post=function(n,r){var t=new FormData;for(var o in r)t.append(o,r[o]);return e.post(n,t,{transformRequest:angular.indentity,headers:{"Content-Type":undefined}}).success(function(e){console.log("DATA IS :"+e)})}}})();(function(){angular.module("pingFyp").controller("historyCtrl",e);function e(){var e=this}})();(function(){angular.module("pingFyp").controller("addguardCtrl",e);function e(){var e=this}})();(function(){angular.module("pingFyp").controller("loginCtrl",e);e.$inject=["authentication","$location"];function e(e,n){var r=this;r.pageHeader={title:"Login in to PING"};r.credentials={email:"",password:""};r.onSubmit=function(){r.formError="";if(!r.credentials.email||!r.credentials.password){r.formError="All fields required, please try again";return false}else{r.doLogin()}};r.doLogin=function(){r.formError="";e.login(r.credentials).error(function(e){if(e.message="Incorrect Password"){r.formError="Password doesnot matches"}else{r.formError=e}}).then(function(){n.path("/supervisor")})}}})();(function(){angular.module("pingFyp").controller("registerCtrl",e);e.$inject=["authentication","multipartForm","$location"];function e(e,n,r){var t=this;t.pageHeader={title:"Create a new PING account"};t.credentials={name:"",email:"",password:"",file:"",phone:"",home_address:""};t.onSubmit=function(){t.formError="";if(!t.credentials.name||!t.credentials.home_address||!t.credentials.file||!t.credentials.phone||!t.credentials.email||!t.credentials.password){t.formError="All fields required, please try again"+t.credentials.name+" "+t.credentials.email+" "+t.credentials.phone+" "+t.credentials.password+" "+t.credentials.home_address+" FILE:"+t.credentials.file.name;return false}else{t.doRegister()}};t.doRegister=function(){t.formError="";var e="/api/supervisorSignup";n.post(e,t.credentials).then(function(){r.path("/login")})}}})();(function(){angular.module("pingFyp").service("authentication",e);e.$inject=["$http","$window"];function e(e,n){var r=function(e){n.localStorage["ping-token"]=e};var t=function(){return n.localStorage["ping-token"]};var o=function(){var e=t();if(e){var r=JSON.parse(n.atob(e.split(".")[1]));return r.exp>Date.now()/1e3}else{return false}};var i=function(){if(o()){var e=t();var r=JSON.parse(n.atob(e.split(".")[1]));return{email:r.email,name:r.name}}};register=function(n){console.log(n);return e.post("/api/supervisorSignup",n).success(function(e){r(e.token)})};login=function(n){return e.post("/api/supervisorLogin",n).success(function(e){r(e.token)})};posting=function(n,r){var t=new FormData;for(var o in r)t.append(o,r[o]);return e.post(n,t,{transformRequest:angular.indentity,headers:{"Content-Type":undefined}}).success(function(e){console.log("DATA IS :"+e)})};logout=function(){n.localStorage.removeItem("ping-token")};return{currentUser:i,saveToken:r,getToken:t,isLoggedIn:o,register:register,login:login,logout:logout}}})();(function(){angular.module("pingFyp").service("meanData",e);e.$inject=["$http","authentication"];function e(e,n){var r=function(){return e.get("/api/users",{headers:{Authorization:"Bearer "+n.getToken()}})};return{getProfile:r}}})();